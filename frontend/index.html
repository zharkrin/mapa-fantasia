<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generador de Mapa Fantástico</title>

  <!-- ================= CSS ================= -->
  <link rel="stylesheet" href="frontend/css/estilo.css" />
  <link rel="stylesheet" href="frontend/css/leyenda.css" />
</head>

<body>
  <header>
    <h1>GENERADOR DE MAPA FANTÁSTICO</h1>
    <p>Terrenos, biomas y lugares singulares</p>
  </header>

  <main>
    <section id="mapa-container">
      <canvas id="mapaCanvas" width="1024" height="768"></canvas>
    </section>

    <!-- Botón y panel de leyenda -->
    <button id="btnLeyenda">Leyenda del Terreno</button>

    <div id="panelLeyenda" class="oculto">
      <div id="leyenda-header">
        <h2>Leyenda</h2>
        <button id="cerrarLeyenda">Cerrar</button>
      </div>
      <div id="leyenda-contenido">
        <ul id="listaLeyenda"></ul>
      </div>
    </div>
  </main>

  <footer>
    <p>© 2025 Generador de Mapa Fantástico — Proyecto en desarrollo</p>
  </footer>

  <!-- ================= JAVASCRIPT ================= -->
  <!-- Librerías base -->
  <script src="frontend/js/perlin.js"></script>

  <!-- Scripts del mapa -->
  <script src="frontend/js/mapa/biomas.js"></script>
  <script src="frontend/js/mapa/coloresTerreno.js"></script>
  <script src="frontend/js/mapa/dibujarMapa.js"></script>
  <script src="frontend/js/mapa/nombresGeograficos.js"></script>
  <script src="frontend/js/mapa/terrenoEspecial.js"></script>
  <script src="frontend/js/mapa/leyendaTerrenoEspecial.js"></script>
  <script src="frontend/js/mapa/generarTerrenoEspecial.js"></script>

  <!-- Script principal -->
  <script src="frontend/js/script.js"></script>

  <!-- ================= INICIALIZACIÓN ================= -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const canvas = document.getElementById("mapaCanvas");
      const ctx = canvas.getContext("2d");
      const ancho = canvas.width;
      const alto = canvas.height;

      // Fondo inicial del mapa
      ctx.fillStyle = "#b8d0f0";
      ctx.fillRect(0, 0, ancho, alto);

      // === Generar terrenos especiales ===
      if (typeof generarTerrenosEspeciales === "function") {
        generarTerrenosEspeciales(ctx, ancho, alto);
      } else {
        console.warn("⚠️ generarTerrenosEspeciales() no está definido.");
      }

      // === Configurar panel de leyenda ===
      const btnLeyenda = document.getElementById("btnLeyenda");
      const panelLeyenda = document.getElementById("panelLeyenda");
      const cerrarLeyenda = document.getElementById("cerrarLeyenda");
      const listaLeyenda = document.getElementById("listaLeyenda");

      if (typeof inicializarLeyendaTerrenoEspecial === "function") {
        inicializarLeyendaTerrenoEspecial(listaLeyenda);
      }

      btnLeyenda.addEventListener("click", () => {
        panelLeyenda.classList.toggle("oculto");
      });

      cerrarLeyenda.addEventListener("click", () => {
        panelLeyenda.classList.add("oculto");
      });
    });
  </script>
</body>
</html>